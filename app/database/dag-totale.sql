SELECT `r`.`ekspo_id`, `o`.`dag`, COUNT(*) as `registrasies`, SUM(`o`.`kinders`) as `kinders`, SUM(`r`.`registrasietiepe_id` = 1 OR `r`.`registrasietiepe_id` = 4) as `vooraf`, SUM(`r`.`registrasietiepe_id` = 9 OR `r`.`registrasietiepe_id` = 12) as `hek`, SUM(`r`.`registrasietiepe_id` = 7 OR `r`.`registrasietiepe_id` = 10) as `gratis`, COUNT(`o`.`registrasie_id`) as `opgedaag` FROM `tblregistrasies` as `r` LEFT JOIN `tblopgedaag` as `o` ON `r`.`id`=`o`.`registrasie_id` WHERE `r`.`ekspo_id`=5 AND (`r`.`geskep_op` BETWEEN "2015-06-26" AND "2015-06-28") GROUP BY `o`.`dag`;

SELECT `r`.`ekspo_id`, `o`.`dag`, COUNT(`r`.`id`) as `registrasies`, SUM(`o`.`kinders`) as `kinders`, SUM((`r`.`registrasietiepe_id` IS NULL) OR `r`.`registrasietiepe_id` = 1 OR `r`.`registrasietiepe_id` = 4) as `vooraf`, SUM(`r`.`registrasietiepe_id` = 9 OR `r`.`registrasietiepe_id` = 12) as `hek`, SUM(`r`.`registrasietiepe_id` = 7 OR `r`.`registrasietiepe_id` = 10) as `gratis`, COUNT(`o`.`registrasie_id`) as `opgedaag` FROM `tblregistrasies` as `r` LEFT JOIN `tblopgedaag` as `o` ON `r`.`id`=`o`.`registrasie_id` WHERE `r`.`ekspo_id`=5 AND (`r`.`geskep_op` BETWEEN "2015-06-26" AND "2015-06-28") GROUP BY `o`.`dag`;

UPDATE `tblregistrasies` `r` SET `r`.`registrasietiepe_id` = 1 WHERE (`r`.`ekspo_id` = 5) AND (`r`.`geskep_op` < "2015-06-26 00:00:00") AND (`r`.`registrasietiepe_id` IS NULL);

SELECT `o`.`dag` as `dag`, COUNT(*) as `almal`, SUM(`r`.`registrasietiepe_id` = 9 OR `r`.`registrasietiepe_id` = 12) as `hek`, SUM(`r`.`registrasietiepe_id` = 7 OR `r`.`registrasietiepe_id` = 10) as `gratis`, SUM(`r`.`geskep_op` <= "2015-06-26 00:00:00") as `vooraf`, SUM(`r`.`registrasietiepe_id` = 1 OR `r`.`registrasietiepe_id` = 4) as `voor`, SUM(`r`.`geskep_op` >= "2015-06-28 00:00:00") as `na` FROM `tblregistrasies` `r` LEFT JOIN `tblopgedaag` `o` ON `r`.`id`=`o`.`registrasie_id` WHERE `r`.`ekspo_id`=5 GROUP BY `o`.`dag`
